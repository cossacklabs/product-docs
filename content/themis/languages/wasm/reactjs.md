---
weight: 5
title:  WASM & ReactJS
---

# Installing WasmThemis in ReactJS application
## How to use Themis in React applications

This article is addressed application developers on React who want to use Themis to make cryptographic features in their products.

The key problem is configuring Webpack to use Themis.

### Why this is the problem?

There are two cases.

The first case is very dumb. Developers need to copy libthemis.wasm file separately. This is stated in the (examples/) [product documentation](installation).

"However, in addition to JavaScript code, WasmThemis also includes the compiled WebAssembly bytecode. The bytecode is located in node_modules/wasm-themis/src/libthemis.wasm file, which will be loaded by the browser separately. Make sure that libthemis.wasm is placed next to the produced JavaScript bundle by copying it from node_modules directory when building your application."

The second case is configuring Webpack. Webpack is the most useful tool for modern JavaScript applications, not only for React applications. This is a static module bundler.  WasmThemis code is generated by Emscripten to be universal. It includes some references to Node.js modules for Node.js support, but they are not accessible in web browsers.

### Create ReactJS application

The easiest way to create a new application is to use the command

```bash
npx create-react-app my-app
```
or
```bash
yarn create react-app my-app --template typescript
```
Let us check that’s all correct.

```bash
cd my-app
yarn start
```

Add react-app-rewired package to tweak create-react-app webpack config without eject.
```bash
yarn add react-app-rewired --dev
```

All the benefits of create-react-app without the limitations of "no config". You can add plugins and loaders whatever you need.

Install the webpack copy plugin that will copy libthemis.wasm to the output directory.
```bash
yarn add copy-webpack-plugin --dev
```
Be sure to add --dev option because you need to add the previous two packages to development dependencies.

## Install the Themis.

```bash
yarn add wasm-themis
yarn add buffer
```

Buffer will be used for conversion between uint8array and base64 encoded strings.

To use react-app-rewired feature need to update package.json. Replace start, build and test values in section “scripts” with the next values:

```json
"scripts": {
   "start": "react-app-rewired start",
   "build": "react-app-rewired build",
   "test" : "react-app-rewired test",
```
{{< hint info >}}
**Important:**
Do NOT flip the call for the eject script. That gets run only once for a project, after which you are given full control over the webpack configuration making react-app-rewired no longer required. There are no configuration options to rewire for the eject script.
{{< /hint >}}

Create config-overrides.js:

```js
const fs = require('fs');
const path = require('path');
const CopyWebpackPlugin = require('copy-webpack-plugin');
const CWD_PATH = fs.realpathSync(process.cwd());
const buildPath = process.env.BUILD_PATH || 'build';
const resolveApp = relativePath => path.resolve(CWD_PATH, relativePath);
const WASM_PATH = path.join(CWD_PATH, 'node_modules', 'wasm-themis/src/libthemis.wasm');
const SCRIPTS_PATH = path.join(resolveApp(buildPath), 'static/js/');
module.exports = function override(config, env) {
   if (!config.plugins) {
       config.plugins = [];
   }
   config.plugins.push(
       new CopyWebpackPlugin({ patterns: [{ from: WASM_PATH, to: SCRIPTS_PATH }] })
   );
   config['resolve']['fallback'] = {
       crypto: false,
       fs: false,
       http: false,
       https: false,
       net: false,
       path: false,
       stream: false,
       tls: false,
       util: false,
       url: false,
       zlib: false,
   }
   return config;
}
```

This file resolves two problems described earlier. Copy libthemis.wasm file to the folder where javaScript files are located and resolve unavailable modules for execution in a browser environment.


### Initialize Themis

```js
import { initialize } from 'wasm-themis';

function App() {
    useEffect(() => {
        initialize().then(() => {
            console.log("Themis initialized");
        }).catch( err => {
            // Themis initialization must be only once.
        })
    }, []);
}
```

{{< hint info >}}
**Important:**
WebAssembly code is loaded and compiled asynchronously so you have to wait for the initialize() promise to complete before using any Themis functions. If Themis is called too early, you will see an error message.
{{< /hint >}}

Recommend to initialize Themis in useEffect() hook or componentDidMount() method.

